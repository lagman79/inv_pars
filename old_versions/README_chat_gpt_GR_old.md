# 📄 AI Invoice Extractor  
## Εφαρμογή εξαγωγής δεδομένων από τιμολόγια με χρήση τεχνολογίας AI

---

# 📑 Πίνακας Περιεχομένων
1. [Εισαγωγή](#-εισαγωγή)
2. [Κύρια Χαρακτηριστικά](#-κύρια-χαρακτηριστικά)
3. [Απαιτήσεις Συστήματος](#-απαιτήσεις-συστήματος)
4. [Εγκατάσταση](#-εγκατάσταση)
5. [Διεπαφή Χρήστη (GUI)](#-διεπαφή-χρήστη-gui)
   - [1. Ρυθμίσεις API](#1-ρυθμίσεις-api)
   - [2. Επιλογή Αρχείων](#2-επιλογή-αρχείων)
   - [3. Παράμετροι Εξαγωγής](#3-παράμετροι-εξαγωγής)
   - [4. Οργάνωση & Μετονομασία Αρχείων](#4-οργάνωση--μετονομασία-αρχείων)
   - [5. Πρόοδος & Καταγραφή (Logs)](#5-πρόοδος--καταγραφή-logs)
   - [6. Κουμπιά Ενεργειών](#6-κουμπιά-ενεργειών)
6. [Λειτουργίες της Εφαρμογής](#-λειτουργίες-της-εφαρμογής)
7. [Παραγόμενο Αρχείο Excel](#-παραγόμενο-αρχείο-excel)
8. [Screenshots](#-screenshots)
9. [Troubleshooting](#-troubleshooting)
10. [Συχνές Ερωτήσεις (FAQ)](#-συχνές-ερωτήσεις-faq)
11. [Γνωστά Όρια & Τεχνικές Παρατηρήσεις](#-γνωστά-όρια--τεχνικές-παρατηρήσεις)
12. [Μελλοντικές Βελτιώσεις](#-μελλοντικές-βελτιώσεις)
13. [Άδεια Χρήσης](#-άδεια-χρήσης)

---

# 🔍 Εισαγωγή
Η εφαρμογή **AI Invoice Extractor** είναι ένα εργαλείο γραφικού περιβάλλοντος (GUI) σε Python, το οποίο χρησιμοποιεί το **Google Gemini AI** για την ανάλυση τιμολογίων και την εξαγωγή δομημένων δεδομένων σε αρχείο **Excel (.xlsx)**.

Υποστηρίζει:
- PDF  
- JPG / JPEG  
- PNG  
- WEBP  

Η εξαγωγή δεδομένων περιλαμβάνει πεδία όπως:
- Ημερομηνία παραστατικού  
- Προμηθευτής & ΑΦΜ  
- Αριθμός παραστατικού  
- Περιγραφή  
- Καθαρή αξία, ΦΠΑ, Τελική αξία  
- MARK (MyData)  
- SERIAL Number  
- Κρατήσεις / Χαρτόσημα / Λοιπά έξοδα  
- Σχετικό παραστατικό  
- Σημεία φόρτωσης & προορισμού  
- Κατηγοριοποίηση δαπάνης (ΕΣΠΑ – προαιρετικό)  
- Δυναμικά πεδία (Full Extract)  

---

# 🚀 Κύρια Χαρακτηριστικά

### ✔ Εξαγωγή δεδομένων με AI  
Χρήση του Google Gemini για επιστροφή δομημένου JSON.

### ✔ Κατηγοριοποίηση δαπανών ΕΣΠΑ (προαιρετική)  
Με βάση:
- **Πράσινη Παραγωγική Επένδυση ΜμΕ**  
- **Βασικός Ψηφιακός Μετασχηματισμός ΜμΕ**

### ✔ Full Extract Mode  
Αναζήτηση *όλων* των πεδίων του τιμολογίου.  
Προσθήκη δυναμικών στηλών στο Excel με ελληνικά κλειδιά.

### ✔ Αυτόματη μετονομασία αρχείων  
Μορφή:
```
ΠΡΟΜΗΘΕΥΤΗΣ_ΑΡΠΑΡΑΣΤΑΤΙΚΟΥ.jpg
```

### ✔ Αυτόματη ταξινόμηση σε φακέλους  
Ανά προμηθευτή.

### ✔ Αρχείο Excel με μορφοποίηση  
- Αυτόματη μετατροπή ημερομηνιών σε DD/MM/YYYY  
- Μορφοποίηση ποσών  
- Επισήμανση αποτυχημένων αρχείων με κόκκινο χρώμα  

---

# 💻 Απαιτήσεις Συστήματος
- **Windows 10/11**
- Python **3.10+**
- Ενεργό **Google Gemini API Key**
- Εγκατεστημένες βιβλιοθήκες (βλ. επόμενη ενότητα)

---

# 📦 Εγκατάσταση
1. Εγκαταστήστε τις απαραίτητες βιβλιοθήκες:

```bash
pip install google-generativeai pandas openpyxl pillow
```

2. Εκτελέστε το πρόγραμμα:

```bash
python invoice_parser_3.py
```

3. Το GUI ανοίγει αυτόματα.

---

# 🖥 Διεπαφή Χρήστη (GUI)

## 1. Ρυθμίσεις API
Εισαγωγή του Google Gemini API Key.

> Η εφαρμογή αποθηκεύει αυτόματα το API Key στο `settings.json` και το φορτώνει σε επόμενη χρήση.

---

## 2. Επιλογή Αρχείων
- **Επιλογή Φακέλου Παραστατικών**  
- **Επιλογή αρχείου Excel εξόδου**  

Υποστηριζόμενοι τύποι αρχείων:
```
PDF, JPG, JPEG, PNG, WEBP
```

---

## 3. Παράμετροι Εξαγωγής

### 🔹 Επιλογή Προγράμματος
- Χωρίς κατηγοριοποίηση  
- Πράσινη Παραγωγική Επένδυση  
- Βασικός Ψηφιακός Μετασχηματισμός  

### 🔹 Full Extract (Δυναμικά Πεδία)
Αν ενεργοποιηθεί:
- Η AI συλλέγει ΟΛΑ τα πεδία που βρίσκονται στο παραστατικό  
- Δημιουργεί επιπλέον στήλες στο Excel με ελληνικά ονόματα  

---

## 4. Οργάνωση & Μετονομασία Αρχείων

### ✔ Αυτόματη Μετονομασία  
Εφαρμόζεται μόνο στα επιτυχημένα τιμολόγια.

### ✔ Ταξινόμηση σε φακέλους  
Η εφαρμογή δημιουργεί φακέλους με βάση τον Προμηθευτή.

Με επιλογή:
- **Copy** (διατηρείται το αρχικό αρχείο)  
- **Move** (μετακίνηση χωρίς αντίγραφο)  

---

## 5. Πρόοδος & Καταγραφή (Logs)
Η εφαρμογή εμφανίζει:
- Πρόοδο (%)
- Τρέχον αρχείο
- Μηνύματα AI
- Σφάλματα
- Αναφορές ενεργειών (rename, move, copy)

Τα logs παραμένουν εντός της συνεδρίας.

---

## 6. Κουμπιά Ενεργειών
- **🚀 Εκκίνηση**
- **🔄 Νέα Εργασία**
- **❌ Έξοδος**

---

# ⚙ Λειτουργίες της Εφαρμογής
Η AI επιστρέφει JSON με τα εξής πεδία:

- `date`
- `supplier_name`
- `supplier_vat`
- `invoice_number`
- `description`
- `net_value`
- `vat_value`
- `total_amount`
- `mark_code`
- `serial_number`
- `extra_charges`
- `related_document`
- `loading_place`
- `destination_place`
- `category_code`
- `notes`
- `dynamic_fields` (αν ενεργοποιηθεί το Full Extract)

---

# 📊 Παραγόμενο Αρχείο Excel

Η εφαρμογή:
- Δημιουργεί Excel με σωστή σειρά στηλών  
- Εφαρμόζει μορφοποίηση ποσών  
- Μετατρέπει ISO → DD/MM/YYYY  
- Χρωματίζει αποτυχημένες εγγραφές  
- Προσθέτει αυτόματα dynamic fields  

---

# 🖼 Screenshots

> Τα παρακάτω paths είναι **τοπικά** και θα λειτουργήσουν όταν ανοίξετε το README.md στον υπολογιστή σας.

### 1️⃣ Κεντρικό GUI  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/1.%20κεντρικό%20GUI.png)

### 2️⃣ Ρυθμίσεις API  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/2.%20api.png)

### 3️⃣ Επιλογή Φακέλου Εισαγωγής  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/3.%20φάκελος%20εισαγωγής.png)

### 4️⃣ Οργάνωση Αρχείων  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/4%20ρυθμίσεις%20-%20οργάνωση.png)

### 5️⃣ Progress Bars & Logs  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/5%20progress%20bars%20&%20logs.png)

### 6️⃣ Κουμπιά Ενεργειών  
![](C:/Users/Manolis/reps/1.%20InvPars_Git/screenshots/6%20start_new%20task%20&%20exit%20buttons.png)

---

# 🛠 Troubleshooting

### ❌ *"API Key Error"*  
Λάθος ή ανενεργό κλειδί Gemini.

### ❌ *"Too Many Requests (429)"*  
Έχετε ξεπεράσει το hourly limit της Google.

### ❌ *"Το AI δεν επέστρεψε έγκυρο JSON"*  
Συνήθως συμβαίνει σε κακής ποιότητας εικόνες.

### ❌ *Timeout*  
Το Google AI άργησε να απαντήσει.  
Λύσεις:
- Μικρότερο batch αρχείων  
- Καλύτερη σύνδεση  

### ❌ Excel Permission Error  
Το Excel αρχείο είναι ανοιχτό → κλείστε το.

---

# ❓ Συχνές Ερωτήσεις (FAQ)

### **1. Μπορώ να επεξεργαστώ μόνο PDF;**  
Όχι — υποστηρίζονται και εικόνες.

### **2. Πώς γίνεται η κατηγοριοποίηση;**  
Με κανόνες που έχουν οριστεί μέσα στο πρόγραμμα.

### **3. Χάνονται τα αρχικά αρχεία;**  
Μόνο αν επιλέξετε **Move**.

### **4. Τα dynamic fields είναι πάντα διαθέσιμα;**  
Μόνο με ενεργό Full Extract.

---

# ⚠ Γνωστά Όρια & Τεχνικές Παρατηρήσεις

- Η ποιότητα OCR εξαρτάται από την Google.  
- Μεγάλα αρχεία αυξάνουν τον χρόνο αναμονής.  
- Τα filenames καθαρίζονται από απαγορευμένους χαρακτήρες.  
- Η AI μπορεί να μην επιστρέψει όλα τα πεδία αν δεν υπάρχουν στο έγγραφο.

---

# 🔮 Μελλοντικές Βελτιώσεις
- Υποστήριξη drag & drop  
- Batch parallel processing  
- Custom mapping columns  
- Αυτόματη ανίχνευση προμηθευτή με fallback σε OCR  

---

# 📜 Άδεια Χρήσης
Το έργο διατίθεται για προσωπική χρήση.  
Η χρήση του Google Gemini API υπόκειται στους δικούς του όρους.

